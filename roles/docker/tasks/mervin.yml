---
- name: deploy mervin
  notify: restart mervin
  block:
    - name: create mervin's git repo
      ansible.builtin.git:
        repo: "{{ mervin_repo }}"
        dest: "{{ mervin_confdir }}"
        clone: true
        update: true
        version: master
        accept_newhostkey: true
        force: true
    - name: update and build mervin's image
      docker_compose:
        project_src: "{{ mervin_confdir }}"
        pull: true
        build: true
        state: present
